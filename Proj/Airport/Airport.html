<!DOCTYPE html>
<html>
<head>
	<title>Airport HUBs</title>
	<meta charset="utf-8" />

	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
   integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
   crossorigin=""/>

  <link rel="stylesheet" href="CSS/MarkerCluster.css" />
  <link rel="stylesheet" href="CSS/MarkerCluster.Default.css" />
  

  
   <!-- create map in fullscreen -->
   <style>
        body {
            padding: 0;
            margin: 0;
        }
        html, body, #mapid {
            height: 100%;
            width: 100%;
        }
    </style>

</head>


<!-- use this if you want to add "var HUB_Master  = " to the geojson file and save it as a .js file -->y
<!-- <script type="text/javascript" src="HUB_Master.js"></script> -->



<body>
   <div id="mapid"></div>

  <!-- Jquery -->
  <script src="JS/jquery-3.2.1.js"></script>   
   <!-- Make sure you put this AFTER Leaflet's CSS -->
	<script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
   integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
   crossorigin=""></script>
  <!-- MarkerCluster -->
  <script src="JS/leaflet.markercluster.js"></script>
  
  <!-- AJAX -->
  <script src="JS/leaflet.ajax.js"></script>   
  <!-- spiderfy location -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/OverlappingMarkerSpiderfier-Leaflet/0.2.6/oms.min.js"></script>

 <!-- Put a div element with a certain id where you want your map to be:-->
<script>
   var map = L.map('mapid').setView([40.5, -95.3], 4);
   L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/light-v9/tiles/256/{z}/{x}/{y}?access_token={accessToken}', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
    maxZoom: 18,
    id: 'mapbox.streets',
    accessToken: 'pk.eyJ1IjoianByZWRtYW4iLCJhIjoianduT2tzOCJ9.bPjlTBZwiU7I3tvf3w-KLg'
}).addTo(map);


var PlaneIcon1 = L.icon({
    iconUrl: 'icons/Plane1.png',
    iconSize: [25,25]
 });

var PlaneIcon2 = L.icon({
    iconUrl: 'icons/Plane2.png',
    iconSize: [25,25]
 });

var markers = L.markerClusterGroup();


//this is used when the geojson is saved as a .js file (js script call from above)
//decided to keep it as a geojson rather than having to alter the script to make is .js compatible 
//L.geoJson(HUB_Master).addTo(map);


function customPoint (feature, layer) {
        layer.bindPopup(feature.properties.airline);
        if (feature.properties.airline ==='Republic') {
            layer.setIcon(PlaneIcon1);
            };
        
        if (feature.properties.airline ==='FedEx') {
            layer.setIcon(PlaneIcon2);
            };
        
  };
//DEFAULT
//var geojsonLayer = new L.GeoJSON.AJAX("HUB_Master.geojson");
//geojsonLayer.addTo(map);

//working
//var geojsonLayer = new L.GeoJSON.AJAX("HUB_Master.geojson");

//Popup
var geojsonLayer = new L.GeoJSON.AJAX("HUB_Master.geojson",{
    onEachFeature: customPoint
  });  


//https://stackoverflow.com/questions/29824478/leaflet-markercluster-with-geojson/29856139#29856139
geojsonLayer.on('data:loaded', function () {
    markers.addLayer(geojsonLayer);
    //console.log(markers);
    map.addLayer(markers);
});


</script>
</body>
</html>